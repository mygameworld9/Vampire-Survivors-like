# 模块: `core` (逻辑层 - 引擎)

该目录构成了**逻辑**层的核心。它作为游戏引擎，负责协调游戏的状态、规则和流程。它使用纯粹的、与框架无关的 TypeScript 编写，对 React 或 DOM 没有任何了解。

---

## 核心类

### `Game.ts`
-   **职责:** 整个游戏模拟的中央控制器。它是包含所有其他实体的“世界”。
-   **功能:**
    -   管理所有活动游戏对象的集合（`enemies`, `projectiles`, `xpOrbs`）。
    -   实现由 `GameComponent` 每帧调用的主 `update(dt)` 和 `draw(ctx)` 游戏循环方法。
    -   处理不同实体类型之间的所有碰撞检测逻辑。
    -   根据 `gameConfig.ts` 中的定时计划控制敌人生成系统。
    -   管理核心子系统，如 `ParticleSystem`。
    -   通过回调系统（例如 `onLevelUp`）与视图层（`GameComponent`）通信，以触发UI更改。

### `Camera.ts`
-   **职责:** 管理游戏的视口。
-   **功能:**
    -   跟踪玩家的位置。
    -   实现平滑的“lerp”（线性插值）跟随相机，以创造流畅的观看体验。
    -   对画布渲染上下文应用 `translate` 变换，确保玩家始终保持在屏幕中心。

### `InputHandler.ts`
-   **职责:** 捕获并提供对用户键盘输入的访问。
-   **功能:**
    -   向窗口附加全局的 `keydown` 和 `keyup` 事件监听器。
    -   维护一个简单的键状态映射（例如 `{ ArrowUp: true, ArrowLeft: false }`）。
    -   此对象每帧被传递到 `Player.update()` 方法中，以确定移动方向。

### `ParticleSystem.ts`
-   **职责:** 管理视觉效果粒子的整个生命周期。
-   **功能:**
    -   提供一个 `emit()` 方法，在特定位置生成粒子爆发。
    -   每帧更新所有活动粒子的位置和生命周期。
    -   移除过期的粒子以维持性能。

### `SoundManager.ts`
-   **职责:** 处理所有游戏音频的加载和播放。
-   **功能:**
    -   必须由用户手势初始化，以符合浏览器的音频策略。
    -   提供一个 `playSound()` 方法，通过键来播放音效。
    -   为每个声音创建新的 `Audio` 实例，以允许重叠播放。
