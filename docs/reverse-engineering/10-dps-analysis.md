# 📊 DPS 与数值平衡深度分析

> 本文档从源代码逆向工程，揭示游戏的核心数值设计逻辑。

---

## 📌 概述

| 分析维度 | 数据范围 |
|:---|:---:|
| 武器类型数 | 9 种 |
| 状态效果类型 | 5 种 |
| 敌人变体 | 8 基础 + 8 精英 |
| DPS 层级 | Tier 1 / 2 / 3 |

---

## 🔥 DPS 核心公式

### 基础 DPS 计算

```
DPS = Damage × (1000 / Cooldown)
```

### 状态效果 DPS 附加

```
Total_DPS = Base_DPS + StatusEffect.magnitude
```

其中 `StatusEffect.magnitude` 对于 BURN/POISON 类型表示每秒伤害。

---

## 📈 武器 DPS 梯度表

### Tier 1 基础武器

| 武器 | 类型 | 伤害 | CD(ms) | 理论DPS | 状态效果 |
|:---|:---|:---:|:---:|:---:|:---|
| 🔫 手枪 | PROJECTILE | 12 | 800 | **15** | - |
| 🥏 回旋镖 | BOOMERANG | 75 | 3000 | **25** | - |
| 🔥 烈阳 | AURA | 15 | 1000 | **15** | BURN 5/s |
| 🗡️ 毒匕首 | MELEE | 25 | 1200 | **21** | POISON 3/s |
| 👻 灵魂宝珠 | ORBITING | 10 | 600 | **17** | - |
| ⛓️ 链电 | CHAIN | 20 | 2000 | **10** ×3 | - |
| 📌 尖刺陷阱 | TRAP | 30 | 3000 | **10** | - |

### Tier 2 进化武器

| 武器 | 伤害 | CD | 理论DPS | 提升倍率 | 特殊机制 |
|:---|:---:|:---:|:---:|:---:|:---|
| 🦾 加特林 | 40 | 150 | **267** | ×17.8 | 穿透+1 |
| 💿 音速飞碟 | 120 | 2000 | **60** | ×2.4 | 无限穿透 |
| 🌞 超新星 | 30 | 500 | **60** | ×4.0 | BURN 20/s |
| 🐍 毒牙 | 65 | 900 | **72** | ×3.4 | POISON 8/s |
| 👁️ 幻影守卫 | 30 | 400 | **75** | ×4.4 | 轨道扩展 |
| ⚡ 电击链 | 55 | 1500 | **37** ×5 | ×3.7 | STUN 0.3s |
| 💎 寒霜地雷 | 50 | 2500 | **20** | ×2.0 | SLOW 60% |

### Tier 3 终极武器

| 武器 | 伤害 | CD | 理论DPS | 累计倍率 | 终极机制 |
|:---|:---:|:---:|:---:|:---:|:---|
| 👹 末日炮 | 150 | 800 | **188** | ×12.5 | 爆炸, 穿透5 |
| 🌌 虚空吞噬 | 180 | 1500 | **120** | ×4.8 | 暗属性, 范围 |
| 🕳️ 黑洞 | 100 | 400 | **250** | ×16.7 | SLOW 80% |
| ☠️ 瘟疫镰刀 | 120 | 700 | **171** | ×8.1 | POISON 15/s + 扩散 |
| 🌀 灵魂漩涡 | 35 | 400 | **88** | ×5.2 | 半径180, 180°/s |
| 🌩️ 风暴编织 | 60 | 1200 | **50** ×6 | ×5.0 | STUN 0.5s |
| 🌑 虚空裂隙 | 25 | 4000 | **6** DOT | - | 持续吸引 |

---

## 🎯 敌人 TTK (Time To Kill) 分析

### 基础敌人

| 敌人 | HP | 速度 | 手枪TTK | 加特林TTK | 末日炮TTK |
|:---|:---:|:---:|:---:|:---:|:---:|
| 🟢 史莱姆 | 20 | 100 | 1.6s | 0.08s | 0.13s |
| 🕷️ 蜘蛛 | 15 | 180 | 1.6s | 0.06s | 0.10s |
| 🦇 蝙蝠 | 15 | 150 | 1.6s | 0.06s | 0.10s |
| 🍄 蘑菇 | 60 | 50 | 4.0s | 0.23s | 0.40s |
| 👻 幽灵 | 15 | 220 | 1.6s | 0.06s | 0.10s |
| 🗿 石像鬼 | 200 | 65 | 13.3s | 0.75s | 1.33s |
| 💀 骷髅 | 40 | 80 | 3.2s | 0.15s | 0.27s |
| 👺 哥布林 | 150 | 130 | 10.0s | 0.56s | 1.00s |

### 精英变体 (HP × 倍率)

| 精英敌人 | 等效HP | 加特林TTK | 黑洞TTK |
|:---|:---:|:---:|:---:|
| 🔴 精英史莱姆 | 60 | 0.23s | 0.24s |
| 🟣 精英蘑菇 | 180 | 0.68s | 0.72s |
| 🟤 精英石像鬼 | 500 | 1.88s | 2.00s |

---

## 🧪 状态效果详解

### 效果类型定义

| 类型 | 字段含义 | 效果说明 |
|:---|:---|:---|
| BURN | magnitude = DPS | 持续火焰伤害 |
| POISON | magnitude = DPS | 持续毒素伤害，可叠加 |
| SLOW | magnitude = 速度倍率 | 0.5 = 减速50% |
| STUN | magnitude = 1 | 完全静止 |
| FREEZE | magnitude = 1 | 完全冻结 (预留) |

### 武器状态效果参数

| 武器 | 效果类型 | 触发率 | 持续时间 | 强度 |
|:---|:---|:---:|:---:|:---:|
| 🔥 烈阳 | BURN | 100% | 3s | 5 DPS |
| 🌞 超新星 | BURN | 100% | 4s | 20 DPS |
| 🕳️ 黑洞 | SLOW | 100% | 1s | 0.2 (80%减速) |
| ❄️ 冰晶碎片 | SLOW | 100% | 2s | 0.5 (50%减速) |
| 🗡️ 毒匕首 | POISON | 100% | 4s | 3 DPS |
| 🐍 毒牙 | POISON | 100% | 5s | 8 DPS |
| ☠️ 瘟疫镰刀 | POISON | 100% | 6s | 15 DPS |
| ⚡ 电击链 | STUN | 100% | 0.3s | 1 |
| 🌩️ 风暴编织 | STUN | 100% | 0.5s | 1 |
| 💎 寒霜地雷 | SLOW | 100% | 3s | 0.4 (60%减速) |

---

## ⚖️ 技能平衡参数

### 被动技能效果

| 技能 | 效果类型 | 数值 | 备注 |
|:---|:---|:---:|:---|
| ❤️ 坚韧 | maxHp × | 1.2 | +20% 最大生命 |
| ➕ 再生 | hpRegen + | 0.5 | +0.5 HP/秒 |
| 💨 疾风 | speed × | 1.1 | +10% 移动速度 |
| 🔥 元素精通 | damage_FIRE/ICE/LIGHTNING × | 1.5 | +50% 元素伤害 |
| 🎯 弹道学 | penetration + | 1 | +1 穿透 |
| 🧛 吸血 | onKill_healPercent + | 0.005 | 击杀回复 0.5% 最大HP |
| 💰 黄金之触 | goldMultiplier × | 1.5 | +50% 金币 |
| ⚔️ 暴击精通 | critChance/critMultiplier + | 8% / 1.8x | 暴击系统 |
| 🛡️ 护盾精通 | shield_interval/charges + | 10s / 1层 | 护盾系统 |
| 🏃 动量 | momentum_* | 见下 | 动量爆发系统 |

### 动量技能详解

```typescript
{
    momentum_maxStacks: 100,        // 最大层数
    momentum_damagePerStack: 0.5,   // 每层+0.5伤害
    momentum_radius: 150            // 爆发范围 150px
}
```

**触发条件**: 移动时积攒层数，停止移动时释放 AOE 爆发

---

## 📐 升级曲线设计

### 通用升级模式

| 升级类型 | 操作符 | 典型值 | 效果 |
|:---|:---|:---:|:---|
| 伤害提升 | add | +5~20 | 线性增长 |
| CD 缩减 | multiply | ×0.8~0.9 | 指数衰减 |
| 穿透提升 | add | +1~2 | 离散增长 |
| 范围扩展 | multiply | ×1.15~1.25 | 百分比增长 |

### 手枪升级曲线示例

| 等级 | 效果 | 累计伤害 | 累计DPS |
|:---:|:---|:---:|:---:|
| 1 | 基础 | 12 | 15 |
| 2 | +1穿透 | 12 | 15 |
| 3 | +5伤害 | 17 | 21 |
| 4 | ×0.9 CD | 17 | 24 |
| 5 | +10伤害 | 27 | 38 |
| 6 | +1穿透 | 27 | 38 |
| 7 | +20伤害 | 47 | 65 |
| 8 | +15伤害 | 62 | 86 |
| MAX | ×1.2伤害 | 74 | 103 |

---

## 🔗 相关文档

| 文档 | 描述 |
|:---|:---|
| [08-evolution-matrix.md](./08-evolution-matrix.md) | 进化配方详解 |
| [05-weapon-data-spec.md](./05-weapon-data-spec.md) | 武器数据规格 |
| [06-skill-data-spec.md](./06-skill-data-spec.md) | 技能数据规格 |
| [07-enemy-spawn-design.md](./07-enemy-spawn-design.md) | 敌人生成设计 |

---

## 📝 源代码位置

```
src/data/weaponData.ts      # 武器基础数据
src/data/skillData.ts       # 技能数据
src/data/enemyData.ts       # 敌人数据
src/data/upgradeData.ts     # 升级效果曲线
src/core/Game.ts            # DPS 计算集成
```
