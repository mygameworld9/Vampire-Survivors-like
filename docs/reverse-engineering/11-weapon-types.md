# 🎯 武器类型与弹道系统分析

> 本文档详细记录游戏中 9 种武器类型的弹道机制与实现细节。

---

## 📌 武器类型概览

| 类型 ID | 名称 | 弹道特性 | 穿透语义 | 代表武器 |
|:---|:---|:---|:---|:---|
| PROJECTILE | 投射物 | 直线飞行 | 可击中敌人数 | 🔫 手枪 |
| BOOMERANG | 回旋镖 | 往返弧线 | 可击中敌人数 | 🥏 回旋镖 |
| AURA | 光环 | 固定范围 | 无意义 (999) | 🔥 烈阳 |
| LASER | 激光 | 即时直线 | 无意义 (999) | ❄️ 冰晶碎片 |
| HOMING_PROJECTILE | 追踪弹 | 目标追踪 | 可击中敌人数 | 🔮 魔法飞弹 |
| LIGHTNING | 闪电 | 即时打击 | 目标数量 | ⚡ 雷杖 |
| MELEE | 近战 | 挥砍弧度 | 可击中敌人数 | 🗡️ 武士刀 |
| CHAIN | 链式 | 弹跳传递 | 弹跳次数 | ⛓️ 链电 |
| TRAP | 陷阱 | 静止放置 | 最大陷阱数 | 📌 尖刺陷阱 |
| ORBITING | 轨道 | 环绕玩家 | 无意义 (999) | 👻 灵魂宝珠 |

---

## 🔫 PROJECTILE (投射物)

### 行为模型

```
发射 → 直线飞行 → 碰撞检测 → 穿透计数 → 销毁
```

### 关键参数

| 参数 | 说明 | 典型值 |
|:---|:---|:---:|
| speed | 飞行速度 (px/s) | 300~700 |
| range | 最大飞行距离 (px) | 800~1200 |
| penetration | 可穿透敌人数 | 1~5 |

### 武器实例

| 武器 | 速度 | 范围 | 穿透 | 特殊 |
|:---|:---:|:---:|:---:|:---|
| 🔫 手枪 | 400 | 800 | 1 | 基础 |
| 🦾 加特林 | 550 | 900 | 2 | 高射速 |
| 👹 末日炮 | 700 | 1200 | 5 | 爆炸标签 |

---

## 🥏 BOOMERANG (回旋镖)

### 行为模型

```
发射 → 前进到 range → 返回到玩家 → 全程碰撞检测
```

### 关键参数

| 参数 | 说明 | 典型值 |
|:---|:---|:---:|
| speed | 飞行速度 | 350~600 |
| range | 最大飞行距离 | 400~800 |
| penetration | 全程可击中数 | 4~999 |

### 武器实例

| 武器 | 速度 | 范围 | 穿透 | 特殊 |
|:---|:---:|:---:|:---:|:---|
| 🥏 回旋镖 | 350 | 400 | 4 | 需升级解锁无限穿透 |
| 💿 音速飞碟 | 600 | 600 | ∞ | 进化自回旋镖 |
| 🌌 虚空吞噬 | 500 | 800 | ∞ | 暗属性 |

---

## 🔥 AURA (光环)

### 行为模型

```
持续存在 → 每 cooldown 毫秒检测范围内敌人 → 造成伤害
```

### 关键参数

| 参数 | 说明 | 典型值 |
|:---|:---|:---:|
| range | 光环半径 (px) | 100~250 |
| cooldown | 伤害tick间隔 (ms) | 400~1000 |
| statusEffect | 附加状态效果 | BURN/SLOW |

### 武器实例

| 武器 | 范围 | CD | 状态效果 |
|:---|:---:|:---:|:---|
| 🔥 烈阳 | 100 | 1000ms | BURN 5/s |
| 🌞 超新星 | 160 | 500ms | BURN 20/s |
| 🕳️ 黑洞 | 250 | 400ms | SLOW 80% |

---

## ❄️ LASER (激光)

### 行为模型

```
即时创建 → 直线穿透 → 持续 ~100ms → 消失
```

### 关键参数

| 参数 | 说明 | 典型值 |
|:---|:---|:---:|
| range | 激光长度 (px) | 600~800 |
| width | 激光宽度 (px) | 10 |
| firePattern | 发射模式 | forward/cardinal/all_8 |

### 发射模式演进

| 模式 | 方向数 | 解锁条件 |
|:---|:---:|:---|
| forward | 1 | 基础 |
| forward_backward | 2 | 升级 Lv.2 |
| cardinal | 4 | 升级 Lv.4 |
| all_8 | 8 | MAX 等级 |

---

## ⛓️ CHAIN (链式)

### 行为模型

```
发射 → 击中第一个目标 → 搜索范围内下一目标 → 弹跳 → 重复直到穿透耗尽
```

### 关键参数

| 参数 | 说明 | 典型值 |
|:---|:---|:---:|
| speed | 弹跳速度 | 400~600 |
| penetration | **弹跳次数** | 2~5 |
| range | **弹跳搜索范围** (px) | 150~250 |

### 武器实例

| 武器 | 弹跳数 | 搜索范围 | 状态效果 |
|:---|:---:|:---:|:---|
| ⛓️ 链电 | 2 | 150 | - |
| ⚡ 电击链 | 4 | 200 | STUN 0.3s |
| 🌩️ 风暴编织 | 5 | 250 | STUN 0.5s |

---

## 👻 ORBITING (轨道)

### 行为模型

```
围绕玩家旋转 → 每 cooldown 检测碰撞 → 造成伤害
```

### 关键参数

| 参数 | 说明 | 典型值 |
|:---|:---|:---:|
| range | **轨道半径** (px) | 80~180 |
| speed | **旋转速度** (°/秒) | 90~180 |
| cooldown | 碰撞检测间隔 | 400~600ms |

### 武器实例

| 武器 | 轨道半径 | 旋转速度 | 伤害 |
|:---|:---:|:---:|:---:|
| 👻 灵魂宝珠 | 80 | 90°/s | 10 |
| 👁️ 幻影守卫 | 120 | 120°/s | 30 |
| 🌀 灵魂漩涡 | 180 | 180°/s | 35 |

---

## 📌 TRAP (陷阱)

### 行为模型

```
玩家移动时放置 → 静止等待 → 敌人进入触发 → 爆炸/持续效果
```

### 关键参数

| 参数 | 说明 | 典型值 |
|:---|:---|:---:|
| cooldown | **放置间隔** (ms) | 2500~4000 |
| penetration | **场上最大数量** | 3~6 |
| range | **触发/爆炸半径** (px) | 40~100 |

### 武器实例

| 武器 | 最大数量 | 触发范围 | 状态效果 |
|:---|:---:|:---:|:---|
| 📌 尖刺陷阱 | 5 | 40 | - |
| 💎 寒霜地雷 | 6 | 60 | SLOW 60% |
| 🌑 虚空裂隙 | 3 | 100 | 持续吸引 + DOT |

---

## 🔗 相关文档

- [05-weapon-data-spec.md](./05-weapon-data-spec.md) - 武器数据规格
- [10-dps-analysis.md](./10-dps-analysis.md) - DPS 深度分析
- [08-evolution-matrix.md](./08-evolution-matrix.md) - 进化配方

---

## 📝 源代码位置

```
src/entities/Projectile.ts          # 基础投射物
src/entities/BoomerangProjectile.ts # 回旋镖
src/entities/LaserProjectile.ts     # 激光
src/entities/LightningProjectile.ts # 闪电
src/entities/HomingProjectile.ts    # 追踪弹
src/entities/SlashProjectile.ts     # 近战挥砍
src/entities/TrapProjectile.ts      # 陷阱
src/entities/ChainProjectile.ts     # 链式弹道
src/entities/OrbitingProjectile.ts  # 轨道弹道
```
